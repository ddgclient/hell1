# DDG Prime MBistVminTC  
Revision 1.0.0 7//2021

# Introduction
MBISTVminTC is an extension over PRIME VminSearch that enables additional configurations and integration and includes the DDG DieRecovery and VminForwarding services from the VMINTC.

The TestClass supports three main modes: Functional, SingleVmin and MultiVmin. SingleVmin supports Vmin searching a single DPS/FIVR/DLVR rail, MultiVmin supports multiple DPS/FIVR/DLVR (Not validated) and Functional executes single point (static voltage) condition.  
For reference use the flows here as data has been inherited in to the MBISTVminTC.  VminTC · Wiki · DDG Client Prime Code Base - TGL / TGL_POC_Code · GitLab (intel.com)This uses CTVs to capture the data from numerous MBIST controllers/memories and finds the data to set HRY for either KS or HRY. It has added features for BISR support (assumes you are reading out raw BISR chains) and BIRA support in the HRY string.   There was also added support for VFDM repair for arrays with column only repairs using virtual fuse.   Things to note for BISR there was added features to clear out unrepaired memories from the BISR chains and an accumulation function to make sure if not all data is available in a single burst no data will be lost due to limitations in MBIST. 

# Methodology
VminSearch Test Method from PRIME provides the basic infrastructure for test execution. Please refer to Prime Test Method Specification.
# Parameters
Reference to MBIST VminTC link for most parameters (critical ones listed below). 
## FailCaptureCount
Inherited from VminTC<br>
Number of capture fails set in capture settings. Default 1 will set stop-on-first-fail. Any value greater than 1 will run full plist unless used in combination with ReturnOn plist options."Total failure count must be > 1 otherwise CTVs will not be captured properly.  0 represents stop on first failure.<br>
## CtvPins
Inherited from VminTC<br>
Comma-separated string with pin names for CTV capture data processing. Data expected to be processed by PinMap decoders.
## TestModes
Inherited from VminTC<br>
#### SingleVmin 
Supports multiple ids if user wants to start and/or update more than one corner. In the case of multiple start values the test class will use the max as the starting point. 
#### MultiVmin 
Expects the number of CornerIdentifiers to match the number and order of VoltageTargets.
#### Functional 
Uses this parameter to modify static voltage condition. When user enters a list of CornerIdentifiers, FlowNumber, VoltageTargets and EndVoltageLimits the static voltage condition will be modified to use values from VminForwardingTable. If voltage in VminForwardingTable is negative (incoming bad or masked) then it will default the VoltageTarget pin/fivr/dlvr to the EndVoltageLimit.
#### Scoreboard 
Enables scoreboardmode.

## ForceConfigFileParseState
Forces all config files to be reloaded for all MBIST configurations to shared storage.
## PrintToItuff
Prints HRY string to ITUFF.  Hry should only be printed 1 time at the end of the flow.
## ClearVariables
Clears variables between Dies.  Resets all values, HRY, BISR, VFDM.  Should be enabled only on first instance in flow or used for debug.
## RecoveryModeDownbin
Allows a recovery down bin if enabled.  Works with the MBIST recovery code.
## BisrMode
Sets whether you want to forward the BISR data or compressed for the patmod.  Internally will always keep track of the raw BISR chain. 
## DffOperation
Sets if you  need to read/write DFFs and which ones.  Since we have recovery/BISR that are owned the list includes all possible options (reads should be enabled when ClearVariables is enabled to pull forward the DFF data for use)
## VFDMconfig
Path to the VFDM config file (if not column only repair leaving this blank disables this function).  This is used for Column only VFDM repairs.  Note if you are enabling this in flow first instance with ClearVariables set should set this config to initialize VFDM values)
## MappingConfig
Path to the Mapping config file (if not column only repair leaving this blank disables this function).  Note if you are enabling this in flow first instance with ClearVariables set should set this config to initialize the proper values)
## Threads
This sets the max # of threads you would like this code to run into the software will choose how to allocate.  
## MbistTestMode
Sets which mode and variables you are setting when running the flow.  HRY is used for BISR/BIRA/VFDM/Recovery, KS used for any KS instance execution without Repair but supports Recovery.  PostRepair is used for post HRY tests without BIRA.  
## CaptureMode
PerPin catures all pattern CTVs and was how the old Python worked.<br>
PerPattern is in development(not validated).  Should save test time as it only returns failing patterns to be processed 
## LookupTableConfigurationFile
Path to the config that is autogenerated from the TVPV cache autoconfig.  
## RecoveryConfigurationFile
Path to the recovery config if not specified it is not enabled.  Note if you are enabling this in flow first instance with ClearVariables set should set this config to initialize the proper values)  Example file attached until a document exists to define all fields.  
## IgnorePrePstFail
In perPin mode will allow you to ignore failures outside of the CTVs that fail. No way to know which pattern is giving the failure outside of CTVs.<br>
PerPattern mode this would allow you to ignore only the reset pattern if there are failures to collect MBIST data.<br>
This should never be enabled in a production program released to factory this is a debug only switch.  
## AdvancedDebug
Enables advanced capture of patterns to allow quick debug of failures.  Gives per Mem controller failures per pattern that fails.
## ScoreboardBaseNumberMbist
Used due to limitations on being able to run scoreboard in MBIST mode properly allows MBIST to override with our ScoreBoard # even if pattern fails.  


## Ports
##### 0, PortType.Fail, "Failed"<br>
##### 1, PortType.Pass, "Passed"<br>
##### 2, PortType.Pass, "Repairable Arrays"<br>
##### 3, PortType.Pass, "Recovery"<br>
##### 4, PortType.Pass, "Repair and Recovery"<br>
##### 5, PortType.Error, "Config Error"<br>
##### 6, PortType.Error, "Missing Corner Case"<br>
##### 7, PortType.Fail, "Failed DTS Monitor"<br>
##### 8, PortType.Fail, "Reset failure"<br>


## Version tracking

| **Date**       | **Version** | **Author**   | **Comments** |
| -------------- | ----------- | ------------ | ------------ |
| July 19, 2021  | 1.0.0       | tlkirkha     |  Initial doc.|       
	









